(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a0b959f","chunk-1c62c81a","chunk-2d0de3ae"],{"39db":function(e,t,r){"use strict";r("911c")},"414c":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("pageContainer",{staticClass:"flex-column"},[r("baseTable",e._b({key:e.key,staticClass:"tabs-active-border--primary",attrs:{option:e.option,data:e.data},scopedSlots:e._u([{key:"menuLeft",fn:function(t){return[r("XlsxTable",{staticClass:"inline-block",attrs:{keepOrigin:!0},on:{"on-select-file":e.onSelectFile}}),e.data.length?r("el-button",{on:{click:e.onAnalysis}},[e._v(" 解析表格 ")]):e._e(),e.formatData.length?r("el-button",{on:{click:e.copyStyledText}},[e._v(" 复制 ")]):e._e()]}},e._l(e.column,(function(t){return{key:""+t.headerName,fn:function(){return[r("div",[r("HeaderSelect",{model:{value:t.keywordType,callback:function(r){e.$set(t,"keywordType",r)},expression:"item.keywordType"}}),e._v(" "+e._s(t.label)+" ")],1)]},proxy:!0}})),{key:"formatTitle",fn:function(t){var a=t.row;return[r("span",{domProps:{innerHTML:e._s(a.formatTitle)}})]}}],null,!0)},"baseTable",e.$attrs,!1))],1)},n=[],i=r("2909"),o=r("1da1"),c=(r("96cf"),r("4de4"),r("d3b7"),r("d81d"),r("7db0"),r("ac1f"),r("5319"),r("1276"),r("4d63"),r("c607"),r("2c3e"),r("25f0"),r("466d"),r("caad"),r("a15b"),r("498a2"),r("405f")),l=r("8115"),s=r("d9ae"),u=r("dce4"),d=r("8583"),f=r("ed08"),p=r("2ef0"),h={components:{XlsxTable:s["a"],HeaderSelect:u["default"]},mixins:[Object(c["default"])(),Object(l["default"])({dataAttrs:{curTabItem:{},tableData:[],postData:{}}})],data:function(){return{column:[],data:[],key:Object(f["D"])()}},computed:{option:function(e){var t=e.column;return{menu:!1,column:t}},formatData:function(e){var t=e.data;return t.filter((function(e){return e.formatTitle}))}},methods:{onSelectFile:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n,i,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a=e.body,n=void 0===a?[]:a,i=e.header,o=i.map((function(e){return{label:e,prop:e,headerName:"".concat(e,"Header")}})),o.push({label:"格式化后标题",prop:"formatTitle"}),t.data=n.map((function(e){return e.formatTitle="",e})),t.column=o,t.key=Object(f["D"])();case 6:case"end":return r.stop()}}),r)})))()},onAnalysis:function(){var e=this.column.find((function(e){return e.keywordType==d["headerDicList"].title}));if(e){var t=this.column.filter((function(e){return e.keywordType==d["headerDicList"].delete})),r=this.column.filter((function(e){return e.keywordType==d["headerDicList"].replace})),a=this.column.filter((function(e){return e.keywordType==d["headerDicList"].used})),n=this.column.filter((function(e){return e.keywordType==d["headerDicList"].keepKeywords})),o=this.column.filter((function(e){return e.keywordType==d["headerDicList"].color||e.keywordType==d["headerDicList"].suffix||e.keywordType==d["headerDicList"].suffixAndColor}));this.data.map((function(c){var l=c[e.prop];n.map((function(e){var t=c[e.prop],r=t.split(/,|，/),a=[];r.map((function(e){var t=new RegExp("\\b".concat(e,"\\b"),"ig"),r=l.match(t);r&&a.push.apply(a,Object(i["a"])(r))}));var n=l.split(/ +/),o=n.filter((function(e){return a.includes(e)}));l=Object(p["uniq"])(o).join(" ")})),t.map((function(e){var t=c[e.prop],r=t.split(/,|，/);r.map((function(e){var t=new RegExp(e,"ig");l=l.replace(t,"")}))})),r.map((function(e,t){var r=c[e.prop],n=r.split(/,|，/);n.map((function(e){var r=new RegExp(e,"ig");l=a[t]?l.replace(r,c[a[t].prop]||""):l.replace(r,"")}))})),o.map((function(e){if(e.keywordType==d["headerDicList"].color){var t=c[e.prop],r=l.split(t);l=r.join("<span class='text-danger'>".concat(t,"</span>"))}else if(e.keywordType==d["headerDicList"].suffixAndColor){var a=c[e.prop];l+="<span class='text-danger'>".concat(a,"</span>")}else{var n=c[e.prop];l+=n}})),c.formatTitle=l.trim()})),this.data=Object(i["a"])(this.data)}else this.$message.error("原表题必选")},copyStyledText:function(){var e=document.createElement("div");e.style.position="absolute",e.style.left="-9999px",e.style.top="-9999px",e.style.opacity=0,e.innerHTML="<div>".concat(Object(p["map"])(this.data,"formatTitle").map((function(e){return e+"<br/>"})).join(""),"</div>"),document.body.appendChild(e);var t=document.createRange();t.selectNode(e);var r=window.getSelection();r.removeAllRanges(),r.addRange(t);try{document.execCommand("copy")}catch(a){}r.removeAllRanges(),document.body.removeChild(e)}}},b=h,m=r("2877"),v=Object(m["a"])(b,a,n,!1,null,"47149ce6",null);t["default"]=v.exports},8583:function(e,t,r){"use strict";r.r(t),r.d(t,"headerDicList",(function(){return a})),r.d(t,"dic",(function(){return n}));r("ac1f");var a={title:"title",delete:"deleteKeyword",keepKeywords:"keepKeywords",replace:"replaceKeyword",color:"colorKeyword",used:"usedKeyword",suffix:"suffix",suffixAndColor:"suffixAndColor"},n=[{label:"原标题",value:a.title},{label:"删除关键字",value:a.delete},{label:"保留关键字",value:a.keepKeywords},{label:"待替换关键字",value:a.replace},{label:"替换关键字",value:a.used},{label:"颜色关键字",value:a.color},{label:"后缀",value:a.suffix},{label:"后缀和颜色",value:a.suffixAndColor}]},"911c":function(e,t,r){},d9ae:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"xlsxContainer",on:{drop:function(t){return t.preventDefault(),e.onDrop.apply(null,arguments)},dragover:function(e){e.preventDefault()},dragleave:function(e){e.preventDefault()}}},[r("div",{attrs:{uiid:"zd-xlsxTable"},on:{click:e.handleUploadBtnClick}},[e._t("default",(function(){return[r("el-button",{attrs:{type:"primary"}},[e._v("上传文件")])]}))],2),r("input",{ref:e.uploadInputId,staticClass:"c-hide",attrs:{type:"file",accept:e.accept},on:{change:e.handkeFileChange}})])},n=[],i=r("1da1"),o=(r("96cf"),r("a9e3"),r("b0c0"),r("ac1f"),r("1276"),r("caad"),r("d3b7"),r("159b"),r("5cc6"),r("907a"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("72f7"),r("b64b"),r("25f0"),r("5319"),r("4de4"),r("4e82"),r("d81d"),r("25ca")),c=r("ed08"),l={name:"vue-xlsx-table",data:function(){return{rawFile:null,workbook:null,tableData:{header:[],body:[]},uploadInputId:(new Date).getUTCMilliseconds()}},props:{options:{type:Object,default:function(){return{}}},accept:{type:String,default:".xlsx, .xls"},className:{type:String,default:"xlsx-button"},limit:{type:Number,default:1/0},isMergeCell:Boolean,keepOrigin:Boolean},computed:{rABS:function(){var e={rABS:!1},t=Object.assign(e,this.options);return t.rABS}},methods:{handkeFileChange:function(e){var t=this;if(null===this.rawFile){var r=this.rawFile=e.target.files[0];if(this.checkFile(r)){var a=this.$loading({lock:!0,text:"上传中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$nextTick((function(){t.$emit("input-file",r),t.$emit("getFileName",r.name)}));var n=r.name.split(".").pop();["csv","tsv"].includes(n)?this.handleCsvFile(a):this.isMergeCell?this.handleXlsxMergeCellFile(a):this.handleXlsxFile(a)}}},onDrop:function(e){this.handkeFileChange({target:{files:e.dataTransfer.files}})},checkFile:function(e){return this.checkAccept(e)&&this.checkSize(e)},checkSize:function(e){return e.size<=this.limit||(this.$message.warning("请上传不超过".concat(this.limit/1024/1024,"M文件")),!1)},checkAccept:function(e){var t=e.name.split(".").pop();return this.accept.indexOf(t)>=0||(this.$message.warning("请上传".concat(this.accept,"文件")),!1)},handleCsvFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,i,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(c["l"])(t.rawFile);case 3:a=r.sent,n=a.Sheets[a.SheetNames[0]],t.formatNumToString(n),t.update_sheet_range(a.Sheets[a.SheetNames[0]]),i=o["b"].sheet_to_json(a.Sheets[a.SheetNames[0]]),t.workbook=a,l=t.xlsxArrToTableArr(i),t.initTable(l),r.next=15;break;case 13:r.prev=13,r.t0=r["catch"](0);case 15:e.close();case 16:case"end":return r.stop()}}),r,null,[[0,13]])})))()},handleXlsxFile:function(e){var t=this;this.fileConvertToWorkbook(this.rawFile).then((function(r){var a=r.Sheets[r.SheetNames[0]];t.formatNumToString(a),t.update_sheet_range(r.Sheets[r.SheetNames[0]]);var n=o["b"].sheet_to_json(r.Sheets[r.SheetNames[0]]);t.workbook=r,e.close(),t.initTable(t.xlsxArrToTableArr(n))})).catch((function(r){t.$emit("on-select-file",!1),e.close()}))},handleXlsxMergeCellFile:function(e){var t=this;this.fileConvertToWorkbook(this.rawFile).then((function(r){var a=r.Sheets[r.SheetNames[0]];t.dealMergeCol(a),t.formatNumToString(a),t.update_sheet_range(a);var n=o["b"].sheet_to_json(a);t.workbook=r,e.close(),t.initTable(t.xlsxArrToTableArr(n))})).catch((function(r){t.$emit("on-select-file",!1),e.close()}))},dealMergeCol:function(e){var t=e["!merges"];t&&t.forEach((function(t){var r=t.s,a=t.e,n=r.r,i=r.c,c=a.r,l=a.c,s=e[o["b"].encode_cell(r)];if(s){s.v;for(var u=n;u<=c;u++)for(var d=i;d<=l;d++){var f=o["b"].encode_cell({r:u,c:d});e[f]=s}}}))},formatNumToString:function(e){var t=/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/i.exec(e["!ref"]),r=[Math.max(t[2]-1,0),Math.max(t[4]-1,0)],a=0,n=0;while(!e[o["b"].encode_cell({c:a,r:r[0]})]&&a<99999)++a;n=a;while(e[o["b"].encode_cell({c:n,r:r[0]})])++n;for(var i={s:{c:+a,r:+r[0]},e:{c:+n,r:+r[1]}},c=i.s.c;c<=i.e.c;c++)for(var l=i.s.r;l<=i.e.r;l++){var s=e[o["b"].encode_cell({c:c,r:l})];!isNaN(Number(s&&s.v))&&String(s&&s.v).length>=12&&(s.w=s.v)}},fileConvertToWorkbook:function(e){var t=this,r=new FileReader;return new Promise((function(a,n){try{r.onload=function(e){var r=new Uint8Array(e.target.result),n=o["a"](r,{type:t.rABS?"binary":"array"});a(n)},r.onerror=function(e){n(e)},t.rABS?r.readAsBinaryString(e):r.readAsArrayBuffer(e)}catch(i){n(i)}}))},xlsxArrToTableArr:function(e){var t=this,r=[],a={};e.forEach((function(e){Object.assign(a,e)}));var n=Object.keys(a),i=n.length,o={};return e.forEach((function(e){o={};for(var a=0;a<i;a++)"number"===typeof e[n[a]]||"string"===typeof e[n[a]]?t.keepOrigin?o[n[a]]=e[n[a]].toString():o[n[a]]=e[n[a]].toString().replace(/^\s+/,"").replace(/\s+$/,"").replace(/^['‘’]/,"")||"":o[n[a]]=e[n[a]]||"";r.push(o)})),{header:n,data:r}},tableArrToXlsxArr:function(e){var t=e.data,r=e.header,a=[],n={};return t=t||[],t.forEach((function(e){n={},e.forEach((function(e,t){n[r[t]]=e})),a.push(n)})),a},initTable:function(e){var t=e.data,r=e.header;this.tableData.header=r,this.tableData.body=t.filter((function(e){var t=r.filter((function(e){return-1===e.indexOf("EMPTY")}))[0];return e[t]})),this.$emit("on-select-file",this.tableData),this.$emit("on-select-all-file",{header:r,body:t})},handleUploadBtnClick:function(){this.clearAllData(),this.$refs[this.uploadInputId].click()},clearAllData:function(){this.$refs[this.uploadInputId].value=null,this.tableData={header:[],body:[]},this.rawFile=null,this.workbook=null},getSheetHeader:function(e,t){var r={},a=[];for(var n in e)"1"===n.replace(/[A-Z]/,"")&&(a.push(n),r[n]=e[n].w);a.sort();for(var i=a.map((function(e){return r[e]})),o=t.length-i.length,c=0;c<o;c++)0===c?i.push("__EMPTY"):i.push("__EMPTY_".concat(c));return i},update_sheet_range:function(e){var t={s:{r:1/0,c:1/0},e:{r:0,c:0}};Object.keys(e).filter((function(e){return"!"!=e.charAt(0)})).map(o["b"].decode_cell).forEach((function(e){t.s.c=Math.min(t.s.c,e.c),t.s.r=Math.min(t.s.r,e.r),t.e.c=Math.max(t.e.c,e.c),t.e.r=Math.max(t.e.r,e.r)})),e["!ref"]=o["b"].encode_range(t)}}},s=l,u=(r("39db"),r("2877")),d=Object(u["a"])(s,a,n,!1,null,"6b2ddd72",null);t["a"]=d.exports},dce4:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("avue-crud-select",e._g(e._b({attrs:{dic:e.dic}},"avue-crud-select",e.$attrs,!1),e.$listeners))},n=[],i=r("8583"),o={data:function(){return{dic:i["dic"]}}},c=o,l=r("2877"),s=Object(l["a"])(c,a,n,!1,null,null,null);t["default"]=s.exports}}]);